<!--
	此示例下载自 https://echarts.apache.org/examples/zh/editor.html?c=scatter-nutrients&code=MYewdgzgLgBAlmAJnYBTCMC8MDeAoGGMAQwFtUAuGABgBoCYBzAJxAFcAHKgRnsLkQ8AbHgC-AbjyhIsCMAAWqUsSwwA2gxxEylGAHJAb3qA30z214SVAA8q1GKL65t5KnqOAX1NPnEVnnbwBdSWloGAAzOFQAG0QASSQUdFU5RWUAOmZURDY0AApQtjBgKDhwGByQACMAKzM4KCUASlwGSqq1OqVUknJ_VQ7SVIRvS0lCDKg2ZjAYVsl7XFEGoPAQlnYOAGFiesYQZgiMbDVAqRXYNc4NkEi9w_UTyNRYRG3iSQB6d5gAL0eANyiMEAXHIwbgwQAhboAhHUAAPqAehVAHw6gE_4wCeToAJUzwpAAnht5MRmFBUowngAtZg5BqpaThRgAGWImNQZN4zUIpBAxXAACFIpMqFBmGxUGIlngACSEp45ABKAHkZQAVAD6AAUAILygASMAA1Pp3i8oMR3sQIBAnvrXu8wGx-REwFAIKkqhBwJ58oUOdNyvtGAgACKvJr4QgGlTYMB7ZSRODfVABw3euC-sDx4gUiDR3J0UHUXMi1nY3H41JmqAyjienLlCslabYIllmvgHKhhptuYi91FWtESPEaOx1OJ5OpoMMR7nVicACyxA4qhwEhaPv9r1SoT2AFFiAo8gVu6UcqwAO5jwiECdMKccAByOlUJ_a8TQjouHBO5_goTKAEI37OOFSXEIBlY8wGVVgOEZKBMRyN873INsWU_K91gAtR4J0XpsG4UZz1EBhFjwvYk1XQ11y3Hd5D3D0eyPEBT2QsYGIo5ht13LtPTKfpagsSwzxQuBvxyBgUK8KwYB_TBsCGBJHW6VAYAAMiU0TBL4yTpK8OTCWvZTVLE_gNKkmTn3QQZEDUwgBLEz4YCuMAAXxIg2EiSIYCgEAfkZEAzBNGB-3ckBvygFIYAKbxmHCsA6hgAAiRg4tSKzz0fIYrGwmAODxM0ADEbm2HJ-iaAAfEqaDwz8CKq_M7FqjcopyS9MPIcxUJnOcbK_Mp_znICTVA8DIOg2CWtQJDgxQt8th2EjzI4NgIGosbasIaq_AvJ4YHkABlep52wWdQvSdgkByABmXMYC-ODrxm1Bdn2czHjARhQpgABaUF2wYBqykvOBVGocR4BgAAedrNm2B65sdF63vkEG4G1bUuum65blSBalpyVAFDxB1KQx5hUjZZBQkxDUdppHI9AAYgAVlVABOAAWP1cs8Xb9pgAAqeAfrWhhxkmaYSJHV45jwTiewbctK1bZCRamJiYFDYkQBAUgKDUSaxKWhiKH5QUHDEmCoJcDMBEZPQ1PsPWULm-0XCc4pgH7UwUsIA3jyNgVUFNlDHlCKAKG4AAmQPP3N3Q9CtyLbaq_xA8sVVLDgCAqAdwgFJcdxPf1jhoygGkEF0LQfaoUJ-zNDb8MDzE04zrOUtz_RjALlCICLupS7AcuYErsIa8U9a1sDv4M7YfsAKoDQxOz88h-ryIzSj88Y5cDgIjQY8M9QTuxPd2anszyH7seg515DOByEgWsqEjr3zClYhXvL5_CFAG5mCodGf4gM_ewz92BllCK_d-LdDLnm_nsOe9NgCIL0P4IB18PIgC4DAcOdBn71EsFAPamJHhQOgTAWBv99B01CNQxOhlgHQIyP2Yozhh6ryFGJehKFF7e3kIbVha9n7IDvhAB-MBzpoOUNYHMODoEIAgUSEh0DyGl0YPIKA_dTRz2oKkbgDMzDaKECg6BY98JqWTmpM0p854pW4T8f4UQeBoLbnoa0tpUD2ggIfFCm99ByG2PUZgXjPyhioKGUmc4aIHi9DxeAiB-KqzEsraY7R6ikDUOHZO8BUlqHOpk_oahuB5LiR-OhDQ0Fv1vtsWs8p5AZANtEKgDNcwyMMhwVgLB0AiIBDUupvCGkwCabmFKJjzGfgqcoT024RGvQAKocANLHYAbAKgoDiDKG0XjxlVPAH6SY2ywBzIWY_ZphEpaXnCFERACFEjYGSEoYgDBwkcEiVxIqqSupJKyZ0BSeFFiPKtrkcOIo5yASpEmBcDBU7pzPnoNp7JUAIE7o3aFLh3aRGAHANgpBO7gBxG_BRYR9yvK6kJMoitF5YjxcWUs8taw5FsVC5uCSUJtxBUTMA1JUiMsAcYtByKmW2JzjoKgbKwWMFSPynldC0GWIOIowyIS1ZrmUM8mWh4YkCHiYK1KTxRbqE_oJbJFzohxGQC-NQorwCcu5f4UZpDPz5ONbEMyEALUcFBVapMEqm4QFtWgsS-TCn-sEnEg1hASnGIaEA4Zq064ESXJajlSZlR4h0AEu4k1uXyowZ6M-TrrlSs4ZK7NTZIBVwiNEAthExDiCAA
	⚠ 请注意，该图表不是 Apache ECharts 官方示例，而是由用户代码生成的。请注意鉴别其内容。
-->
<!DOCTYPE html>
<html lang="zh-CN" style="height: 100%">
<head>
  <meta charset="utf-8">
</head>
<body style="height: 100%; margin: 0">
  <div id="container" style="height: 100%"></div>

  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script>
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
  <!-- Uncomment this line if you want to dataTool extension
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@5.4.3/dist/extension/dataTool.min.js"></script>
  -->
  <!-- Uncomment this line if you want to use gl extension
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts-gl@2/dist/echarts-gl.min.js"></script>
  -->
  <!-- Uncomment this line if you want to echarts-stat extension
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts-stat@latest/dist/ecStat.min.js"></script>
  -->
  <!-- Uncomment this line if you want to use map
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@4.9.0/map/js/china.js"></script>
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@4.9.0/map/js/world.js"></script>
  -->
  <!-- Uncomment these two lines if you want to use bmap extension
  <script type="text/javascript" src="https://api.map.baidu.com/api?v=3.0&ak=YOUR_API_KEY"></script>
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@5.4.3/dist/extension/bmap.min.js"></script>
  -->

  <script type="text/javascript">
    var dom = document.getElementById('container');
    var myChart = echarts.init(dom, null, {
      renderer: 'canvas',
      useDirtyRect: false
    });
    var app = {};
    var ROOT_PATH = 'https://echarts.apache.org/examples';
    var option;

    const indices = {
  name: 0,
  group: 1,
  id: 16
};
const schema = [
  { name: '延时', index: 0 },
  { name: '时间', index: 1 }
];
const fieldIndices = schema.reduce(function (obj, item) {
  obj[item.name] = item.index;
  return obj;
}, {});
const groupCategories = [];
const groupColors = [];
let data;
// zlevel 为 1 的层开启尾迹特效
myChart.getZr().configLayer(1, {
  motionBlur: true
});
$.get(ROOT_PATH + '/data/asset/data/nutrients.json', function (originData) {
  data = normalizeData(originData).slice(0, 1000);
  myChart.setOption((option = getOption(data)));
});
function normalizeData(originData) {
  let groupMap = {};
  originData.forEach(function (row) {
    let groupName = row[indices.group];
    if (!groupMap.hasOwnProperty(groupName)) {
      groupMap[groupName] = 1;
    }
  });
  originData.forEach(function (row) {
    row.forEach(function (item, index) {
      if (
        index !== indices.name &&
        index !== indices.group &&
        index !== indices.id
      ) {
        // Convert null to zero, as all of them under unit "g".
        row[index] = parseFloat(item) || 0;
      }
    });
  });
  for (let groupName in groupMap) {
    if (groupMap.hasOwnProperty(groupName)) {
      groupCategories.push(groupName);
    }
  }
  let hStep = Math.round(300 / (groupCategories.length - 1));
  for (let i = 0; i < groupCategories.length; i++) {
    groupColors.push(echarts.color.modifyHSL('#5A94DF', hStep * i));
  }
  return originData;
}
function getOption(data) {
  return {
    dataZoom:[{
        show:true,
        type: 'slider'
    },{
        orient: 'vertical',
        show:true,
        left:12,
        type: 'slider'
    }],
    xAxis: {
      name: '时间',
      splitLine: { show: false }
    },
    yAxis: {
      name: '延时',
      splitLine: { show: false }
    },
    visualMap: [
      {
        show: false,
        type: 'piecewise',
        categories: groupCategories,
        dimension: 2,
        inRange: {
          color: groupColors
        },
        outOfRange: {
          color: ['#ccc']
        },
        top: 20,
        textStyle: {
          color: '#fff'
        },
        realtime: false
      },
      {
        show: false,
        dimension: 3,
        max: 100,
        inRange: {
          colorLightness: [0.15, 0.6]
        }
      }
    ],
    series: [
      {
        zlevel: 1,
        name: 'nutrients',
        type: 'scatter',
        data: data.map(function (item, idx) {
          return [item[2], item[3], item[1], idx];
        }),
        animationThreshold: 5000,
        progressiveThreshold: 5000
      }
    ],
    animationEasingUpdate: 'cubicInOut',
    animationDurationUpdate: 2000
  };
}
let fieldNames = schema
  .map(function (item) {
    return item.name;
  })
  .slice(2);
app.config = {
  xAxis: 'protein',
  yAxis: 'calcium',
  onChange: function () {
    if (data) {
      myChart.setOption({
        xAxis: {
          name: app.config.xAxis
        },
        yAxis: {
          name: app.config.yAxis
        },
        series: {
          data: data.map(function (item, idx) {
            return [
              item[fieldIndices[app.config.xAxis]],
              item[fieldIndices[app.config.yAxis]],
              item[1],
              idx
            ];
          })
        }
      });
    }
  }
};
app.configParameters = {
  xAxis: {
    options: fieldNames
  },
  yAxis: {
    options: fieldNames
  }
};

    if (option && typeof option === 'object') {
      myChart.setOption(option);
    }

    window.addEventListener('resize', myChart.resize);
  </script>
</body>
</html>